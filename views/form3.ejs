<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form 3 - RSVP Application</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
        }
    </style>
</head>
<body class="bg-white">
<div class="min-h-screen bg-white">
    <div class="max-w-3xl mx-auto px-6">
        <!-- Banner -->
        <div class="mt-8 rounded-t-lg overflow-hidden">
            <img src="/images/banner.jpg" alt="Banner" class="w-full h-auto">
        </div>

        <!-- Main Content -->
        <div class="py-8">
            <h2 class="text-2xl font-semibold text-gray-800 mb-2 text-center">香港賽馬會呈獻：「馬到功成耀香江」馬年煙花滙演</h2>
        <h2 class="text-2xl font-semibold text-gray-800 mb-2 text-center">The Hong Kong Jockey Club Presents: </h2>
        <h2 class="text-2xl font-semibold text-gray-800 mb-2 text-center">"Prosperity Gallops Across Hong Kong"</h2>
        <h2 class="text-2xl font-semibold text-gray-800 mb-2 text-center">Year of the Horse Fireworks Display </h2>
            <p class="text-gray-600 mb-6">請填寫以下資料完成活動報名
                Please fill in the following information to complete event registration</p>

        <% if (typeof error !== 'undefined' && error) { %>
            <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
                <%= error %>
            </div>
        <% } %>

        <form method="POST" action="/form3" id="form3" class="bg-white">
            <div class="mb-8">
                
                <div class="space-y-6">
                    <!-- Surname -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *姓(英文) / Surname in English <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="surname" required
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Given Name -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *名(英文) / Given Name in English <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="givenName" required
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Chinese Name -->
                    <div>
                        <div class="grid grid-cols-12 gap-2">
                            <div class="col-span-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    姓(中文) / Surname in Chinese
                                </label>
                                <input type="text" name="chineseSurname"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div class="col-span-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    名(中文) / Given Name in Chinese
                                </label>
                                <input type="text" name="chineseGivenName"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>

                    <!-- Title of Respect -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *稱謂 / Title of Respect <span class="text-red-500">*</span>
                        </label>
                        <select name="titleOfRespect" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">--- Please select ---</option>
                            <option value="Mr">先生 / Mr</option>
                            <option value="Mrs">太太 / Mrs</option>
                            <option value="Ms">女士 / Ms</option>
                            <option value="Miss">小姐 / Miss</option>
                        </select>
                    </div>

                    <!-- Company / Organization -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            公司 / 機構 / Company / Organization
                        </label>
                        <input type="text" name="company"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Title -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            職銜 / Title
                        </label>
                        <input type="text" name="title"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Mobile Country Code and Mobile -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            手提電話 / Mobile
                        </label>
                        <div class="grid grid-cols-12 gap-2">
                            <div class="col-span-3">
                                <select name="mobileCountryCode"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <%- include('partials/country-codes') %>
                                </select>
                            </div>
                            <div class="col-span-9">
                                <input type="tel" name="mobile"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>

                    <!-- Email -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *電子郵件 / Email (以提供活動入場二維碼) (For generating admission QR code) <span class="text-red-500">*</span>
                        </label>
                        <input type="email" name="email" required
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Attend -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            您會否出席馬年煙花匯演? Will you attend "Year of the Horse Fireworks Display"? <span class="text-red-500">*</span>
                        </label>
                        <div class="flex gap-6">
                            <label class="flex items-center">
                                <input type="radio" name="attend" value="Yes" required class="mr-2" onchange="toggleAttendSections()">
                                <span>出席 / Yes</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="attend" value="No" required class="mr-2" onchange="toggleAttendSections()">
                                <span>不出席 / No</span>
                            </label>
                        </div>
                    </div>

                    <!-- Food Allergy -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            食物敏感(如有請註明) / Food Allergy (Please specify if any)
                        </label>
                        <input type="text" name="foodAllergy"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
            </div>

            <!-- Spouse Information (Yellow Background) -->
            <div id="spouseSection" class="mb-8 p-6 bg-yellow-50 border border-yellow-200 rounded-lg hidden">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">攜眷 / With Spouse</h3>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        攜眷 / With Spouse
                    </label>
                    <div class="flex gap-6">
                        <label class="flex items-center">
                            <input type="radio" name="withSpouse" value="Yes" required class="mr-2" onchange="toggleSpouseFields()">
                            <span>是 / Yes</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="withSpouse" value="No" required class="mr-2" onchange="toggleSpouseFields()">
                            <span>否 / No</span>
                        </label>
                    </div>
                </div>

                <div id="spouseFields" class="space-y-6 hidden">
                    <!-- Spouse Surname -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *姓(英文) / Surname in English <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="spouseSurname"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Spouse Given Name -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *名(英文) / Given Name in English <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="spouseGivenName"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Spouse Chinese Name -->
                    <div>
                        <div class="grid grid-cols-12 gap-2">
                            <div class="col-span-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    姓(中文) / Surname in Chinese
                                </label>
                                <input type="text" name="spouseChineseSurname"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div class="col-span-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    名(中文) / Given Name in Chinese
                                </label>
                                <input type="text" name="spouseChineseGivenName"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>

                    <!-- Spouse Title of Respect -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *稱謂 / Title of Respect <span class="text-red-500">*</span>
                        </label>
                        <select name="spouseTitleOfRespect"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">--- Please select ---</option>
                            <option value="Mr">先生 / Mr</option>
                            <option value="Mrs">太太 / Mrs</option>
                            <option value="Ms">女士 / Ms</option>
                            <option value="Miss">小姐 / Miss</option>
                        </select>
                    </div>

                    <!-- Spouse Mobile Country Code and Mobile -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            手提電話 / Mobile
                        </label>
                        <div class="grid grid-cols-12 gap-2">
                            <div class="col-span-3">
                                <select name="spouseMobileCountryCode"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <%- include('partials/country-codes') %>
                                </select>
                            </div>
                            <div class="col-span-9">
                                <input type="tel" name="spouseMobile"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>

                    <!-- Spouse Email -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *電子郵件 / Email (以提供活動入場二維碼) (For generating admission QR code)  <span class="text-red-500">*</span>
                        </label>
                        <input type="email" name="spouseEmail"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Spouse Food Allergy -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            食物敏感(如有請註明) / Food Allergy (Please specify if any)
                        </label>
                        <input type="text" name="spouseFoodAllergy"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
            </div>

            <!-- Children Information -->
            <div id="childrenSection" class="mb-8 p-6 bg-blue-50 border border-blue-200 rounded-lg hidden">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">攜同子女 / With Children</h3>
                
                <!-- Step 1: 是否攜同子女 -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        攜同子女 / With Children
                    </label>
                    <div class="flex gap-6">
                        <label class="flex items-center">
                            <input type="radio" name="withChildren" value="Yes" required class="mr-2" onchange="toggleChildrenSection()">
                            <span>是 / Yes</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="withChildren" value="No" required class="mr-2" onchange="toggleChildrenSection()">
                            <span>否 / No</span>
                        </label>
                    </div>
                </div>

                <!-- Step 2: 攜同子女數目 -->
                <div id="numberOfChildrenSection" class="mb-6 hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        攜同子女數目 / Number of Children
                    </label>
                    <div class="flex gap-6">
                        <label class="flex items-center">
                            <input type="radio" name="numberOfChildren" value="1" class="mr-2" onchange="toggleChildrenFields()">
                            <span>1</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="numberOfChildren" value="2" class="mr-2" onchange="toggleChildrenFields()">
                            <span>2</span>
                        </label>
                    </div>
                </div>

                <!-- Child 1 Information -->
                <div id="child1Fields" class="space-y-6 hidden">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">子女(1) / Child 1</h4>
                    
                    <!-- Child 1 Surname -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *姓(英文) / Surname in English <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="child1Surname"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Child 1 Given Name -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *名(英文) / Given Name in English <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="child1GivenName"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Child 1 Chinese Name -->
                    <div>
                        <div class="grid grid-cols-12 gap-2">
                            <div class="col-span-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    姓(中文) / Surname in Chinese
                                </label>
                                <input type="text" name="child1ChineseSurname"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div class="col-span-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    名(中文) / Given Name in Chinese
                                </label>
                                <input type="text" name="child1ChineseGivenName"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>

                    <!-- Child 1 Title of Respect -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *稱謂 / Title of Respect <span class="text-red-500">*</span>
                        </label>
                        <select name="child1TitleOfRespect"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">--- Please select ---</option>
                            <option value="Mr">先生 / Mr</option>
                            <option value="Mrs">太太 / Mrs</option>
                            <option value="Ms">女士 / Ms</option>
                            <option value="Miss">小姐 / Miss</option>
                        </select>
                    </div>

                    <!-- Child 1 Mobile Country Code and Mobile -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            手提電話 / Mobile 
                        </label>
                        <div class="grid grid-cols-12 gap-2">
                            <div class="col-span-3">
                                <select name="child1MobileCountryCode"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <%- include('partials/country-codes') %>
                                </select>
                            </div>
                            <div class="col-span-9">
                                <input type="tel" name="child1Mobile"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>

                    <!-- Child 1 Email -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *電子郵件 / Email (以提供活動入場二維碼) (For generating admission QR code)  <span class="text-red-500">*</span>
                        </label>
                        <input type="email" name="child1Email"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Child 1 Food Allergy -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            食物敏感(如有請註明) / Food Allergy (Please specify if any)
                        </label>
                        <input type="text" name="child1FoodAllergy"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <!-- Child 2 Information -->
                <div id="child2Fields" class="space-y-6 hidden mt-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">子女(2) / Child 2</h4>
                    
                    <!-- Child 2 Surname -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *姓(英文) / Surname in English <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="child2Surname"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Child 2 Given Name -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *名(英文) / Given Name in English <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="child2GivenName"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Child 2 Chinese Name -->
                    <div>
                        <div class="grid grid-cols-12 gap-2">
                            <div class="col-span-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    姓(中文) / Surname in Chinese
                                </label>
                                <input type="text" name="child2ChineseSurname"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div class="col-span-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    名(中文) / Given Name in Chinese
                                </label>
                                <input type="text" name="child2ChineseGivenName"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>

                    <!-- Child 2 Title of Respect -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *稱謂 / Title of Respect <span class="text-red-500">*</span>
                        </label>
                        <select name="child2TitleOfRespect"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">--- Please select ---</option>
                            <option value="Mr">先生 / Mr</option>
                            <option value="Mrs">太太 / Mrs</option>
                            <option value="Ms">女士 / Ms</option>
                            <option value="Miss">小姐 / Miss</option>
                        </select>
                    </div>

                    <!-- Child 2 Mobile Country Code and Mobile -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            手提電話 / Mobile 
                        </label>
                        <div class="grid grid-cols-12 gap-2">
                            <div class="col-span-3">
                                <select name="child2MobileCountryCode"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <%- include('partials/country-codes') %>
                                </select>
                            </div>
                            <div class="col-span-9">
                                <input type="tel" name="child2Mobile"
                                    placeholder="fill in the blank"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>

                    <!-- Child 2 Email -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            *電子郵件 / Email (以提供活動入場二維碼) (For generating admission QR code)  <span class="text-red-500">*</span>
                        </label>
                        <input type="email" name="child2Email"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Child 2 Food Allergy -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            食物敏感(如有請註明) / Food Allergy (Please specify if any)
                        </label>
                        <input type="text" name="child2FoodAllergy"
                            placeholder="fill in the blank"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
            </div>

            <!-- Important Notes -->
            <div class="mb-6 text-sm text-gray-600">
                <p>*必須提供 / Items must be provided</p>
                <p>#所有出席者的電郵地址必須各不相同 / All attendees must register with distinct email addresses</p>
            </div>

            <!-- Privacy Policy -->
            <div class="mb-8 p-4 bg-gray-50 rounded-lg">
                <div class="mb-4">
                    <p class="text-sm text-gray-700 mb-2">
                        By submitting this form, you are deemed to have agreed that this platform and The Hong Kong Jockey Club may collect and use the relevant personal data, and have read and accepted The Hong Kong Jockey Club's Privacy Policy Statement available at 
                        <a href="https://www.hkjc.com/home/english/corporate/corp_privacy.aspx" target="_blank" class="text-blue-600 hover:underline">https://www.hkjc.com/home/english/corporate/corp_privacy.aspx</a>. 
                        If you provide any personal data of any third party, you are deemed to have obtained authorisation to provide and allow this platform and The Hong Kong Jockey Club to collect and use the relevant personal data. Personal data may also be disclosed to third party services providers of this platform and The Hong Kong Jockey Club for the purposes of organising the event.
                    </p>
                    <p class="text-sm text-gray-700">
                        如閣下回覆此表格，將被視為已同意本平台及香港賽馬會收集及使用有關個人資料，並已閱讀及同意香港賽馬會載於下述網址的私隱條款: 
                        <a href="https://www.hkjc.com/home/chinese/corporate/corp_privacy.aspx" target="_blank" class="text-blue-600 hover:underline">https://www.hkjc.com/home/chinese/corporate/corp_privacy.aspx</a>. 
                        如閣下提供他人的個人資料，閣下將被視為已取得足夠授權提供及容許本平台及香港賽馬會收集及使用有關個人資料。個人資料可能會提供予本平台及香港賽馬會的第三方服務供應商，以作活動安排之用。
                    </p>
                </div>
                <div class="flex items-start">
                    <input type="checkbox" name="privacyConsent" id="privacyConsent" required
                        class="mt-1 mr-2 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label for="privacyConsent" class="text-sm text-gray-700">
                        我已閱讀並同意上述隱私政策 I have read and accepted to the above privacy policy. <span class="text-red-500">*</span>
                    </label>
                </div>
            </div>

            <!-- Buttons -->
            <div class="flex gap-4 justify-end">
                <button type="submit" class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                    提交 Submit
                </button>
            </div>
        </form>
        </div>
    </div>
</div>

<script>
function toggleAttendSections() {
    const attend = document.querySelector('input[name="attend"]:checked');
    const spouseSection = document.getElementById('spouseSection');
    const childrenSection = document.getElementById('childrenSection');
    
    if (attend && attend.value === 'Yes') {
        spouseSection.classList.remove('hidden');
        childrenSection.classList.remove('hidden');
    } else {
        spouseSection.classList.add('hidden');
        childrenSection.classList.add('hidden');
        // 重置攜眷選項
        document.querySelectorAll('input[name="withSpouse"]').forEach(radio => {
            radio.checked = false;
        });
        toggleSpouseFields();
        // 重置子女選項
        document.querySelectorAll('input[name="withChildren"]').forEach(radio => {
            radio.checked = false;
        });
        toggleChildrenSection();
    }
}

function toggleSpouseFields() {
    const withSpouse = document.querySelector('input[name="withSpouse"]:checked');
    const spouseFields = document.getElementById('spouseFields');
    const spouseInputs = spouseFields.querySelectorAll('input, select');
    
    if (withSpouse && withSpouse.value === 'Yes') {
        spouseFields.classList.remove('hidden');
        spouseInputs.forEach(input => {
            // 排除中文姓名欄位，只設置英文姓名、稱謂和Email為必填
            if ((input.name.includes('Surname') && !input.name.includes('Chinese')) || 
                (input.name.includes('GivenName') && !input.name.includes('Chinese')) || 
                input.name.includes('TitleOfRespect') || input.name.includes('Email')) {
                input.setAttribute('required', 'required');
            }
        });
    } else {
        spouseFields.classList.add('hidden');
        spouseInputs.forEach(input => {
            input.removeAttribute('required');
            input.value = '';
        });
    }
}

function toggleChildrenSection() {
    const withChildren = document.querySelector('input[name="withChildren"]:checked');
    const numberOfChildrenSection = document.getElementById('numberOfChildrenSection');
    const child1Fields = document.getElementById('child1Fields');
    const child2Fields = document.getElementById('child2Fields');
    
    if (withChildren && withChildren.value === 'Yes') {
        numberOfChildrenSection.classList.remove('hidden');
    } else {
        numberOfChildrenSection.classList.add('hidden');
        child1Fields.classList.add('hidden');
        child2Fields.classList.add('hidden');
        // 清除所有小孩欄位
        clearChildrenFields();
        // 清除選擇
        document.querySelectorAll('input[name="numberOfChildren"]').forEach(radio => {
            radio.checked = false;
        });
    }
}

function toggleChildrenFields() {
    const numberOfChildren = document.querySelector('input[name="numberOfChildren"]:checked');
    const child1Fields = document.getElementById('child1Fields');
    const child2Fields = document.getElementById('child2Fields');
    
    if (!numberOfChildren) {
        child1Fields.classList.add('hidden');
        child2Fields.classList.add('hidden');
        clearChildrenFields();
        return;
    }
    
    const count = parseInt(numberOfChildren.value);
    
    if (count >= 1) {
        child1Fields.classList.remove('hidden');
        setRequiredFields(child1Fields, true);
    } else {
        child1Fields.classList.add('hidden');
        setRequiredFields(child1Fields, false);
        clearChildFields(child1Fields);
    }
    
    if (count >= 2) {
        child2Fields.classList.remove('hidden');
        setRequiredFields(child2Fields, true);
    } else {
        child2Fields.classList.add('hidden');
        setRequiredFields(child2Fields, false);
        clearChildFields(child2Fields);
    }
}

function setRequiredFields(container, required) {
    const inputs = container.querySelectorAll('input, select');
    inputs.forEach(input => {
        // 排除中文姓名欄位，只設置英文姓名、稱謂和Email為必填
        if ((input.name.includes('Surname') && !input.name.includes('Chinese')) || 
            (input.name.includes('GivenName') && !input.name.includes('Chinese')) || 
            input.name.includes('TitleOfRespect') || input.name.includes('Email')) {
            if (required) {
                input.setAttribute('required', 'required');
            } else {
                input.removeAttribute('required');
            }
        }
    });
}

function clearChildFields(container) {
    const inputs = container.querySelectorAll('input, select');
    inputs.forEach(input => {
        input.value = '';
    });
}

function clearChildrenFields() {
    clearChildFields(document.getElementById('child1Fields'));
    clearChildFields(document.getElementById('child2Fields'));
}

// 表單提交前驗證
document.getElementById('form3').addEventListener('submit', function(e) {
    const attend = document.querySelector('input[name="attend"]:checked');
    // 只有選擇出席時才驗證攜眷和子女資料
    if (attend && attend.value === 'Yes') {
        const emails = [document.querySelector('input[name="email"]').value.toLowerCase()];
        
        // 收集所有 email
        const withSpouse = document.querySelector('input[name="withSpouse"]:checked');
        if (withSpouse && withSpouse.value === 'Yes') {
            const spouseEmail = document.querySelector('input[name="spouseEmail"]').value.toLowerCase();
            if (spouseEmail) emails.push(spouseEmail);
        }
        
        const withChildren = document.querySelector('input[name="withChildren"]:checked');
        const numberOfChildren = document.querySelector('input[name="numberOfChildren"]:checked');
        
        if (withChildren && withChildren.value === 'Yes' && numberOfChildren) {
            const count = parseInt(numberOfChildren.value);
            
            if (count >= 1) {
                const child1Email = document.querySelector('input[name="child1Email"]');
                if (child1Email && child1Email.value) {
                    emails.push(child1Email.value.toLowerCase());
                }
            }
            
            if (count >= 2) {
                const child2Email = document.querySelector('input[name="child2Email"]');
                if (child2Email && child2Email.value) {
                    emails.push(child2Email.value.toLowerCase());
                }
            }
        }
        
        // 檢查 email 唯一性
        const uniqueEmails = [...new Set(emails)];
        if (emails.length !== uniqueEmails.length) {
            e.preventDefault();
            alert('所有出席者的電郵地址必須各不相同');
            return false;
        }
    }
});
</script>
</body>
</html>
